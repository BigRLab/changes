<div ng-if="!isSingleJob" ng-include="'partials/includes/job-header.html'"></div>

<!--
<ul class="nav nav-justified nav-tabs phase-list" ng-if="phases">
    <li ng-repeat="phase in phases" class="status-{{phase.status.id}} result-{{phase.result.id}}">
        <a href="/jobs/{{job.id}}/phases/">{{phase.name}}</a>
    </li>
</ul> -->
<div ui-view>
    <section class="section" ng-if="isSingleJob">
        <div ng-include="'partials/includes/build-info.html'"></div>
    </section>

    <div ng-include="'partials/includes/job-test-failures.html'"></div>
    <div ng-include="'partials/includes/job-file-coverage.html'"></div>

    <section ng-repeat="phase in phases" class="section">
        <div class="section-header result-{{phase.result.id}}">
            <div class="line"></div>
            <div class="indicator-wrapper">
                <div ng-if="phase.status.id == 'finished'">
                    <div class="indicator"></div>
                </div>
                <div ng-if="phase.status.id != 'finished'">
                    <span class="spinner-icon"></span>
                </div>
            </div>
            <h3>{{phase.name}}</h3>
            <div class="toggle">
                <a ng-click="phase.isVisible = !phase.isVisible">Toggle Details</a>
            </div>
            <div class="timing" ng-if="phase.duration">
                <span duration="phase.duration"></span>
            </div>
        </div>
        <div ng-if="phase.isVisible" class="section-body">
            <div ng-if="logSourcesByPhase[phase.id]">
                <tabset type="'links'">
                    <tab ng-repeat="logSource in logSourcesByPhase[phase.id]" class="result-{{logSource.step.result.id}}"
                         heading="{{logSource.name}}"
                         select="loadLogSource(logSource)">

                        <div class="build-log-wrapper" id="log-{{logSource.id}}" bind-once>
                            <div class="build-log"></div>
                            <a ui-sref="log_details({source_id: logSource.id})" class="expand-log-link"><i class="glyphicon glyphicon-new-window"></i>Expand Log</a>
                        </div>

                    </tab>
                </tabset>
            </div>
            <div ng-if="!logSourcesByPhase[phase.id]">
                <p>No logs have been captured for this phase.</p>
            </div>
        </div>
    </section>

    <div ng-if="isSingleJob" ng-include="'partials/includes/build-event-list.html'"></div>
</div>
